# SAS Audit Script

This script is designed to perform an audit of a Windows system using various commands and tools. It retrieves important information about the system configuration, user accounts, security policies, installed software, network connections, event logs, file integrity, scheduled tasks, services, registry settings, patch level, and vulnerability assessment.

## Prerequisites

Before running this script, please ensure that the following dependencies are met:

- Windows operating system
- PowerShell installed
- Internet access for downloading dependencies

## Usage

1. Clone or download this repository to your local machine.
2. Open a command prompt or PowerShell terminal.
3. Navigate to the directory where the script is located.
4. Run the script using the following command:

`audit.bat`

## Script Steps

The script performs the following steps:

1. Sets up the work directory and creates necessary subdirectories.
2. Downloads dependencies, including PSTools, wpc-2.0, and windows-privesc-check.
3. Performs basic enumeration of the system, including system information and hostname.
4. Obtains information about the current user using the `whoami` command.
5. Retrieves information about users and local groups on the machine.
6. Checks the password policy for the system.
7. Generates an inventory of installed software.
8. Lists open ports and network connections.
9. Analyzes event logs for the system.
10. Performs a file integrity check for the kernel32.dll file.
11. Lists scheduled tasks and services on the system.
12. Analyzes the registry for startup entries.
13. Assesses the patch level and vulnerability using installed hotfixes.
14. Additional commands or actions can be added at this point in the script.
15. Completes the audit and displays a completion message.

## Output

The script saves the output files in the following directory:

`%HOMEPATH%\Downloads%computername%-SAS_Audit\`

The output files generated by the script include:

- `%computername%_systeminfo.txt`: System information and hostname.
- `%computername%_whoami.txt`: Information about the current user.
- `%computername%_usr-grp.txt`: Users and local groups on the machine.
- `%computername%_password_policy.txt`: Password policy for the system.
- `%computername%_installed_software.csv`: Inventory of installed software.
- `%computername%_network_connections.txt`: Open ports and network connections.
- `%computername%_event_log.txt`: Analysis of event logs.
- `%computername%_file_integrity.txt`: File integrity check for kernel32.dll.
- `%computername%_scheduled_tasks.txt`: Scheduled tasks on the system.
- `%computername%_services.txt`: Services on the system.
- `%computername%_registry_analysis.txt`: Analysis of startup entries in the registry.
- `%computername%_patch_level.csv`: Patch level and installed hotfixes.

Note: `%computername%` is replaced with the actual computer name when generating the output files.

## License

This script is released under the [MIT License](LICENSE). Feel free to use and modify it according to your needs.

## Disclaimer

The script provided here is intended for auditing purposes and should be used responsibly. The authors cannot be held responsible for any misuse or damages caused by using this script.
